{
  "name": "HorseScript",
  "scopeName": "source.horsescript",
  "patterns": [
    {
      "include": "#expression"
    }
  ],
  "repository": {
    "expression": {
      "patterns": [
        {
          "include": "#functions"
        },
        {
          "include": "#magicstrings"
        },
        {
          "include": "#operators"
        },
        {
          "include": "#classes"
        },
        {
          "include": "#fieldvalues"
        },
        {
          "include": "#fieldmetadata"
        },
        {
          "include": "#strings"
        },
        {
          "include": "#constants"
        },
        {
          "include": "#punctuation"
        },
        {
          "include": "#default"
        }
      ]
    },
    "functions": {
      "patterns": [
        {
          "match": "\\b(?:toString)\\b",
          "name": "entity.name.function.tostring.horsescript"
        }
      ]
    },
    "magicstrings": {
      "patterns": [
        {
          "match": "(?<=\\W|^)@currentField(?=\\W|$)",
          "name": "variable.language.currentfield.horsescript"
        },
        {
          "match": "(?<=\\W|^)@now(?=\\W|$)",
          "name": "variable.language.now.horsescript"
        }
      ]
    },
    "operators": {
      "patterns": [
        {
          "match": "\\b(?:if)\\b",
          "name": "keyword.control.conditional.horsescript"
        },
        {
          "match": "(>|<|\\?|:|==|<=|>=|!=|&&|\\|\\||\\+|-|\\*|/|&)",
          "name": "keyword.operator.horsescript"
        }
      ]
    },
    
    "classes": {
      "patterns": [
        {
          "match": "'ms-bgColor-(red|redDark|yellow|yellowLight|themePrimary|themeSecondary)'",
          "name": "constant.other.horsescript"
        }
      ]
    },
    "fieldvalues": {
      "begin": "\\[\\$",
      "beginCaptures": {
        "0": {
          "name": "punctuation.section.brackets.begin.horsescript"
        }
      },
      "end": "\\]",
      "endCaptures": {
        "0": {
          "name": "punctuation.section.brackets.end.horsescript"
        }
      },
      "name": "variable.parameter.horsescript",
      "patterns": [
        {
          "match": "[^\\]]+",
          "name": "variable.parameter.inner.horsescript"
        }
      ]
    },
    "fieldmetadata": {
      "begin": "\\[\\!",
      "beginCaptures": {
        "0": {
          "name": "punctuation.section.brackets.begin.horsescript"
        }
      },
      "end": "\\]",
      "endCaptures": {
        "0": {
          "name": "punctuation.section.brackets.end.horsescript"
        }
      },
      "name": "variable.parameter.horsescript",
      "patterns": [
        {
          "match": "[^\\]]+",
          "name": "variable.parameter.inner.horsescript"
        }
      ]
    },
    "strings": {
      "patterns": [
        {
          "begin": "'",
          "end": "'",
          "name": "string.quoted.single.horsescript"
        }
      ]
    },
    "constants": {
      "patterns": [
        {
          "match": "\\b(?:true|false)\\b",
          "name": "constant.language.boolean.horsescript"
        },
        {
          "match": "^=",
          "name": "support.constant.expressionprefix.horsescript"
        }
      ]
    },
    "punctuation": {
      "patterns": [
        {
          "match": ",",
          "name": "punctuation.separator.parameters.horsescript"
        },
        {
          "match": "\\(",
          "name": "punctuation.section.parens.begin.horsescript"
        },
        {
          "match": "\\)",
          "name": "punctuation.section.parens.end.horsescript"
        }
      ]
    },
    
    "default": {
      "match": ".",
      "name": "invalid.illegal.horsescript"
    }
  }
}